import groovy.json.JsonSlurper

buildscript {
    ext {
        willPublishReactNativeBridgeBinary = properties["willPublishReactNativeBridgeBinary"]?.toBoolean() ?: false

        compileSdkVersion = 30
        minSdkVersion = 21
        targetSdkVersion = 30

        react = {
            enableHermes = true
        }

        // Fetch React Native version from Gutenberg package.json
        def gutenbergPackageJson = new JsonSlurper().parse file("$rootDir/../../../package.json")
        def devDependencies = gutenbergPackageJson.get('devDependencies')
        rnVersion = devDependencies.get('react-native')
    }
}

plugins {
    id "com.android.library" apply false
    id "org.jetbrains.kotlin.android" apply false
    id "com.automattic.android.publish-to-s3" apply false
}

allprojects {
    repositories {
        if (willPublishReactNativeBridgeBinary) {
            maven { url "https://a8c-libs.s3.amazonaws.com/android/react-native-mirror" }
        } else {
            maven { url "$rootDir/../../../node_modules/react-native/android" }
        }
    }
}
